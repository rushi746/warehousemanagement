<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coil Management</title>
  
  <!-- ‚úÖ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Hide placement-controls by default */
    #placementModal {
      display: none;
    }
    #placementOverlay {
      display: none;
    }
  </style>
</head>

<div id="coilIdLabel" style="
  position: absolute;
  color: white;
  background: rgba(0,0,0,0.7);
  padding: 4px 8px;
  border-radius: 4px;
  pointer-events: none;
  font-weight: bold;
  display: none;
  z-index: 10;
"></div>



<body class="m-0 overflow-hidden font-sans">

  <!-- ‚úÖ Loading Screen -->
  <div id="loading-screen" class="fixed inset-0 bg-black bg-opacity-80 text-white flex justify-center items-center text-2xl z-[1000]">
    Loading Assets...
  </div>

  <!-- ‚úÖ Top Controls -->
  <div class="absolute top-5 left-5 bg-white bg-gradient-to-br from-white to-gray-100 shadow-lg rounded-xl p-4 flex items-center gap-3 z-50 border border-gray-200">
    <button id="addAssetButton" disabled
      class="px-4 py-2 text-sm font-semibold text-white rounded-md transition bg-blue-600 disabled:bg-blue-300">
      Add New Coil
    </button>

    <input type="text" id="searchInput" placeholder="Enter Coil ID"
      class="px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 w-44">

    <button id="searchButton" disabled
      class="px-4 py-2 text-sm font-semibold text-white rounded-md transition bg-orange-500 disabled:bg-orange-300">
      Search
    </button>
  </div>

  <!-- ‚úÖ Placement Modal Overlay -->
  <div id="placementOverlay" class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-50 z-[9998] hidden"></div>

  <!-- ‚úÖ Placement Modal Popup -->
  <div id="placementModal" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
      bg-white rounded-xl shadow-xl p-6 w-80 z-[9999] hidden">
    <h2 class="text-lg font-bold mb-4">üìç Place New Coil</h2>

    <div class="flex flex-col gap-3">
      <label class="text-sm font-semibold">Row:</label>
      <input type="number" id="rowInput" value="0" min="0"
        class="px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">

      <label class="text-sm font-semibold">Column:</label>
      <input type="number" id="colInput" value="0" min="0"
        class="px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">

      <label class="text-sm font-semibold">Layer:</label>
      <input type="number" id="layerInput" value="0" min="0"
        class="px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">

      <button id="manualPlaceButton"
        class="mt-3 px-4 py-2 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700">
        ‚úÖ Place Coil Here
      </button>
      <button id="closePlacementModal"
        class="mt-2 px-4 py-2 bg-gray-400 text-white font-semibold rounded-md hover:bg-gray-500">
        ‚ùå Cancel
      </button>
    </div>
  </div>

  <!-- ‚úÖ Custom Coil Request Dialog -->
  <div id="dialogOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[9998]"></div>

  <div id="coilDialog" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2
      bg-gradient-to-br from-white to-gray-100 rounded-xl p-6 border border-gray-300 shadow-xl z-[9999] w-96 max-w-[90%]">
    <p class="text-lg font-medium text-gray-800 mb-4">
      üÜï A new coil request has been made.<br>Do you want to add it?
    </p>
    <div class="text-right">
      <button id="rejectBtn"
        class="bg-red-500 text-white px-4 py-2 rounded-md mr-2 hover:bg-red-600">
        ‚ùå Reject
      </button>
      <button id="acceptBtn"
        class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">
        ‚úÖ Accept
      </button>
    </div>
  </div>

  <!-- ‚úÖ Three.js Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r150/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>

  <!-- ‚úÖ Your Main JS File -->
  <script type="module" src="/src/main.js"></script>

  <!-- ‚úÖ JS for Modal -->
  <script>
    const addAssetButton = document.getElementById("addAssetButton");
    const placementModal = document.getElementById("placementModal");
    const placementOverlay = document.getElementById("placementOverlay");
    const closePlacementModal = document.getElementById("closePlacementModal");

    // Open modal when Add New Coil is clicked
    addAssetButton.addEventListener("click", () => {
      placementModal.style.display = "block";
      placementOverlay.style.display = "block";
    });

    // Close modal when clicking cancel
    closePlacementModal.addEventListener("click", () => {
      placementModal.style.display = "none";
      placementOverlay.style.display = "none";
    });

    // Close modal when clicking overlay
    placementOverlay.addEventListener("click", () => {
      placementModal.style.display = "none";
      placementOverlay.style.display = "none";
    });

    // ‚úÖ Handle placing coil
    document.getElementById("manualPlaceButton").addEventListener("click", () => {
      const row = parseInt(document.getElementById("rowInput").value);
      const col = parseInt(document.getElementById("colInput").value);
      const layer = parseInt(document.getElementById("layerInput").value);

      if (isNaN(row) || isNaN(col) || isNaN(layer)) {
        alert("‚ö†Ô∏è Please enter valid numbers.");
        return;
      }

      // üî• Call your existing function from main.js
      if (typeof placeCoilAt === "function") {
        placeCoilAt(row, col, layer);
      } else {
        console.warn("placeCoilAt function not found in main.js");
      }

      // Close modal
      placementModal.style.display = "none";
      placementOverlay.style.display = "none";
    });
  </script>



</body>

</html>
